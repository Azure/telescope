apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namePrefix: client-
resources:
  - ../../base

patches:
  - target:
      kind: Deployment
      name: iperf3-deployment
    patch: |-
      apiVersion: apps/v1
      kind: Deployment
      metadata:
        name: iperf3-deployment
      spec:
        template:
          spec:
            hostNetwork: true
            nodeSelector:
              app: client
            containers:
              - name: iperf3-client
                args: ["-c", "ldconfig; sleep infinity"]
labels:
  - includeSelectors: true
    pairs:
      app: iperf3-client
