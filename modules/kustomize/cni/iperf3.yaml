apiVersion: v1
kind: Pod
metadata:
  name: iperf3-client
  namespace: default
  labels:
    app: iperf3
spec:
  nodeSelector:
    kubernetes.io/hostname: aks-default-42863573-vms2
  containers:
    - name: tester
      image: telescope.azurecr.io/perf-eval/iperf3.18:v20250415
      command: ["sleep", "infinity"]
---
apiVersion: v1
kind: Pod
metadata:
  name: iperf3-server
  namespace: default
  labels:
    app: iperf3
spec:
  nodeSelector:
    kubernetes.io/hostname: aks-default-42863573-vms3
  containers:
    - name: tester
      image: telescope.azurecr.io/perf-eval/iperf3.18:v20250415
      command: ["iperf3", "-s", "-p", "20003"]
      ports:
        - containerPort: 20003
---
apiVersion: v1
kind: Service
metadata:
  name: iperf3-service
spec:
  selector:
    app: iperf3                  # must match the pod label
  ports:
  - protocol: TCP
    port: 5201                  # service port
    targetPort: 5201            # container port
  type: ClusterIP

