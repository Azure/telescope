parameters:
  - name: cloud
    type: string
    default: ""
  - name: regions
    type: object
    default: {}
  - name: engine_input
    type: object
    default: {}

steps:
  - template: /steps/cloud/${{ parameters.cloud }}/collect-cloud-info.yml
    parameters:
      region: ${{ parameters.region }}
  - template: /steps/engine/iperf3/collect-pod-node-info.yml
    parameters:
      cluster_cli_context: "${{ parameters.engine_input.cluster_name.client }}-${{ parameters.cloud }}"
      cluster_srv_context: "${{ parameters.engine_input.cluster_name.server }}-${{ parameters.cloud }}"
  - template: /steps/engine/iperf3/collect.yml
    parameters:
      iperf_properties: ${{ parameters.engine_input.iperf3_command_array }}
      cluster_cli_context: "${{ parameters.engine_input.cluster_name.client }}-${{ parameters.cloud }}"
      cluster_srv_context: "${{ parameters.engine_input.cluster_name.server }}-${{ parameters.cloud }}"
