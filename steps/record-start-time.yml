parameters:
- name: variable_name
  type: string
  default: 'STEP_START_EPOCH'
- name: display_name
  type: string
  default: 'Record step execution start time'

steps:
- script: |
    set -eo pipefail
    start_epoch=$(PYTHONPATH=$PYTHONPATH:$(pwd) python3 $PYTHON_SCRIPT_FILE --current)
    echo "Start epoch time: $start_epoch"
    # Set variable for use in subsequent steps
    echo "##vso[task.setvariable variable=${{ parameters.variable_name }}]$start_epoch"
  workingDirectory: modules/python/
  displayName: '${{ parameters.display_name }}'
  continueOnError: true
  env:
    PYTHON_SCRIPT_FILE: $(Pipeline.Workspace)/s/modules/python/utils/calculate_duration.py