trigger: none

variables:
  SCENARIO_TYPE: perf-eval
  SCENARIO_NAME: cri-eviction-eval
stages:
  - stage: azure_swedencentral-memory-standard
    dependsOn: []
    jobs:
      - template: /jobs/cri-kubeconfig-eval.yml
        parameters:
          cloud: azure
          regions:
            - swedencentral
          engine: clusterloader2
          engine_input:
            image: "ghcr.io/azure/clusterloader2:v20250311"
          topology: cri-eviction-eval
          loadConfig:
            type: memory
            usage: oversubscribed
          evictionConfig:
            memory: 100Mi
          matrix:
            n5-p150-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 30
              node_count: 5
            n5-p350-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 70
              node_count: 5
            n5-p550-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 110
              node_count: 5
  - stage: azure_swedencentral-memory-oversubscribed
    dependsOn: []
    jobs:
      - template: /jobs/cri-kubeconfig-eval.yml
        parameters:
          cloud: azure
          regions:
            - swedencentral
          engine: clusterloader2
          engine_input:
            image: "ghcr.io/azure/clusterloader2:v20250311"
          topology: cri-eviction-eval
          loadConfig:
            type: memory
            usage: oversubscribed
          evictionConfig:
            memory: 100Mi
          matrix:
            n5-p150-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 30
              node_count: 5
            n5-p350-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 70
              node_count: 5
            n5-p550-100mi-d8:
              k8s_machine_type: Standard_D8ds_v4
              max_pods: 110
              node_count: 5