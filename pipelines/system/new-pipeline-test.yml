trigger: none
variables:
  SCENARIO_TYPE: perf-eval
  SCENARIO_NAME: k8s-gpu-cluster-crud
stages:
  - stage: azure_H100_gpu_test
    dependsOn: []
    jobs:
      - template: /jobs/competitive-test.yml
        parameters:
          cloud: azure
          regions:
            - australiaeast
          terraform_input_file_mapping:
            - australiaeast: "scenarios/perf-eval/k8s-gpu-cluster-crud/terraform-inputs/azure-scriptless.tfvars"
          topology: k8s-crud-gpu
          engine: crud
          matrix:
            h100_gpu_node_pool:
              gpu_node_pool: true
              pool_name: h100nodepool
              vm_size: Standard_NC40ads_H100_v5
              create_node_count: 0
              scale_node_count: 2
              scale_step_size: 1
              step_time_out: 600
              step_wait_time: 30
              run_nccl_tests: "false"
          max_parallel: 1
          credential_type: service_connection
          ssh_key_enabled: false
          timeout_in_minutes: 180
